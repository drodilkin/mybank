<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ultra Demo Bank</title>

<style>

body{
margin:0;
font-family:system-ui;
background:#0f172a;
color:white;
}

.container{
max-width:420px;
margin:auto;
padding:20px;
}

.card{
background:#1e293b;
padding:20px;
border-radius:20px;
margin-bottom:15px;
}

.bank-card{
background:linear-gradient(135deg,#22c55e,#16a34a);
padding:20px;
border-radius:20px;
margin-bottom:15px;
}

input{
width:100%;
padding:12px;
margin-top:10px;
border-radius:10px;
border:none;
}

button{
width:100%;
padding:12px;
margin-top:10px;
border-radius:10px;
border:none;
background:#22c55e;
color:white;
font-size:16px;
cursor:pointer;
}

#bank{display:none}

.history-item{
background:#020617;
padding:10px;
border-radius:10px;
margin-top:5px;
}

</style>

</head>
<body>

<div class="container">

<h2>üè¶ Ultra Demo Bank</h2>

<div id="login" class="card">
<h3>Login</h3>
<input id="email">
<input id="password" type="password">
<button onclick="login()">Login</button>
</div>

<div id="bank">

<div class="bank-card">
<div>üí≥ Card</div>
<div id="card"></div>
<div id="balance"></div>
<button onclick="logout()">Logout</button>
</div>

<div class="card">
<h3>Transfer</h3>
<input id="to">
<input id="amount">
<button onclick="transfer()">Send</button>
</div>

<div class="card">
<h3>History</h3>
<div id="history"></div>
<button onclick="loadHistory()">Refresh</button>
</div>

</div>

</div>

<script>

const API="https://script.google.com/macros/s/AKfycbx4_5O8KJiL4sOJEF_sCAXcx6qLY3BV4_CKiApVjbEKj3vtKzjW9negndsywmZw0eIq_A/exec";

let user=null;

window.onload=()=>{

const saved=localStorage.getItem("bankUser");

if(saved){

user=JSON.parse(saved);

openBank();
refreshBalance();
loadHistory();

setInterval(refreshBalance,5000);
}
}

function openBank(){

document.getElementById("login").style.display="none";
document.getElementById("bank").style.display="block";

updateUI();
}

function updateUI(){

document.getElementById("balance").innerText="Balance: "+user.balance;
document.getElementById("card").innerText=user.card;
}

async function login(){

const res=await fetch(API,{
method:"POST",
body:JSON.stringify({
action:"login",
email:document.getElementById("email").value,
password:document.getElementById("password").value
})
});

const data=await res.json();

if(data.status==="success"){

user=data;

localStorage.setItem("bankUser",JSON.stringify(user));

openBank();
loadHistory();

setInterval(refreshBalance,5000);

}else{
alert("Wrong login");
}
}

async function refreshBalance(){

const res=await fetch(API,{
method:"POST",
body:JSON.stringify({
action:"balance",
email:user.email
})
});

const data=await res.json();

if(data.status==="success"){

user.balance=data.balance;

localStorage.setItem("bankUser",JSON.stringify(user));

updateUI();
}
}

async function transfer(){

const res=await fetch(API,{
method:"POST",
body:JSON.stringify({
action:"transfer",
from:user.email,
to:document.getElementById("to").value,
amount:document.getElementById("amount").value
})
});

const data=await res.json();

if(data.status==="success"){

user.balance=data.newBalance;

localStorage.setItem("bankUser",JSON.stringify(user));

updateUI();
loadHistory();

alert("Sent");

}else{
alert(data.status);
}
}

async function loadHistory(){

const res=await fetch(API,{
method:"POST",
body:JSON.stringify({
action:"history"
})
});

const data=await res.json();

if(data.status==="success"){

const box=document.getElementById("history");

box.innerHTML="";

data.data.reverse().forEach(r=>{

const div=document.createElement("div");
div.className="history-item";
div.innerText=r[1]+" ‚Üí "+r[2]+" : "+r[3];
box.appendChild(div);

});
}
}

function logout(){

localStorage.removeItem("bankUser");
location.reload();
}

</script>

</body>
</html>
