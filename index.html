<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¶ –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ë–∞–Ω–∫ —Å Google Form</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { 
            max-width: 500px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 { color: #333; margin-bottom: 30px; text-align: center; }
        input, select { 
            width: 100%; 
            padding: 12px; 
            margin: 10px 0; 
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        button { 
            width: 100%; 
            padding: 14px; 
            background: linear-gradient(to right, #667eea, #764ba2);
            color: white; 
            border: none; 
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 0;
        }
        .balance { 
            font-size: 32px; 
            text-align: center; 
            margin: 20px 0;
            color: #28a745;
            font-weight: bold;
        }
        .message { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            text-align: center;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .logout-btn { background: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè¶ –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ë–∞–Ω–∫</h1>
        
        <div id="loginScreen">
            <h3>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
            <input type="text" id="loginEmail" placeholder="Email" value="tilyas@mail.ru">
            <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" value="80223">
            <button onclick="login()">–í–æ–π—Ç–∏</button>
            
            <div class="message info">
                <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</strong><br>
                ‚Ä¢ tilyas@mail.ru / 80223<br>
                ‚Ä¢ Prokhor@mail.ru / 71601<br>
                ‚Ä¢ Roma@mail.ru / 23312<br>
                ‚Ä¢ Artem@mail.ru / 94331
            </div>
            
            <div id="loginMessage" class="message"></div>
        </div>
        
        <div id="bankScreen" style="display:none">
            <h3>üëã <span id="userName"></span></h3>
            <div class="balance" id="balance">50000 ‚Çø</div>
            
            <h4>üí∏ –ü–µ—Ä–µ–≤–æ–¥</h4>
            <select id="toUser">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>
            </select>
            <input type="number" id="amount" placeholder="–°—É–º–º–∞" min="1">
            
            <button onclick="transfer()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
            <button onclick="logout()" class="logout-btn">–í—ã–π—Ç–∏</button>
            
            <div id="bankMessage" class="message"></div>
        </div>
    </div>

    <script>
        // –î–ê–ù–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô
        const users = [
            {id: 1, email: 'tilyas@mail.ru', password: '80223', balance: 50000},
            {id: 2, email: 'prokhor@mail.ru', password: '71601', balance: 50000},
            {id: 3, email: 'roma@mail.ru', password: '23312', balance: 50000},
            {id: 4, email: 'artem@mail.ru', password: '94331', balance: 50000}
        ];
        
        let currentUser = null;
        
        // ========== –í–ê–®–ê GOOGLE FORM ==========
        const GOOGLE_FORM_ID = '1FAIpQLScTjPMG7gOVc1xVXLdRm9_j4aaTn-ZFETokrIRvev11AxteTA';
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ Google Form
        async function saveToGoogleForm(from, to, amount) {
            try {
                console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Google Form:', {from, to, amount});
                
                // URL –≤–∞—à–µ–π —Ñ–æ—Ä–º—ã
                const url = `https://docs.google.com/forms/d/e/${GOOGLE_FORM_ID}/formResponse`;
                
                // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ ID –ø–æ–ª–µ–π (–Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à–∏)
                const fieldIds = [
                    'entry.1361860196', // –í–æ–∑–º–æ–∂–Ω—ã–π ID –¥–ª—è "–û—Ç –∫–æ–≥–æ"
                    'entry.1065046570', // –í–æ–∑–º–æ–∂–Ω—ã–π ID –¥–ª—è "–ö–æ–º—É"  
                    'entry.1166974658', // –í–æ–∑–º–æ–∂–Ω—ã–π ID –¥–ª—è "–°—É–º–º–∞"
                    'entry.839337160'  // –í–æ–∑–º–æ–∂–Ω—ã–π ID –¥–ª—è "–î–∞—Ç–∞"
                ];
                
                // –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const formData = new FormData();
                formData.append(fieldIds[0], from);
                formData.append(fieldIds[1], to);
                formData.append(fieldIds[2], amount.toString());
                formData.append(fieldIds[3], new Date().toLocaleDateString('ru-RU'));
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º (no-cors –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
                await fetch(url, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: formData
                });
                
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google Form');
                return true;
                
            } catch (error) {
                console.log('‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Google Form:', error);
                return false;
            }
        }
        
        // ========== –§–£–ù–ö–¶–ò–ò –ë–ê–ù–ö–ê ==========
        
        function showMessage(elementId, text, type) {
            const element = document.getElementById(elementId);
            element.textContent = text;
            element.className = `message ${type}`;
            
            if (type !== 'info') {
                setTimeout(() => {
                    element.textContent = '';
                    element.className = 'message';
                }, 4000);
            }
        }
        
        function login() {
            const email = document.getElementById('loginEmail').value.toLowerCase().trim();
            const password = document.getElementById('loginPassword').value.trim();
            
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —ç–∫—Ä–∞–Ω—ã
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('bankScreen').style.display = 'block';
                document.getElementById('userName').textContent = email;
                document.getElementById('balance').textContent = `${user.balance} ‚Çø`;
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
                const select = document.getElementById('toUser');
                select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>';
                
                users.forEach(u => {
                    if (u.email !== email) {
                        const option = document.createElement('option');
                        option.value = u.email;
                        option.textContent = `${u.email} (${u.balance} ‚Çø)`;
                        select.appendChild(option);
                    }
                });
                
                showMessage('loginMessage', '‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!', 'success');
                
            } else {
                showMessage('loginMessage', '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
            }
        }
        
        async function transfer() {
            if (!currentUser) return;
            
            const toEmail = document.getElementById('toUser').value;
            const amount = parseInt(document.getElementById('amount').value);
            
            if (!toEmail) {
                showMessage('bankMessage', '–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è', 'error');
                return;
            }
            
            if (!amount || amount <= 0) {
                showMessage('bankMessage', '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É', 'error');
                return;
            }
            
            if (amount > currentUser.balance) {
                showMessage('bankMessage', `‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –î–æ—Å—Ç—É–ø–Ω–æ: ${currentUser.balance} ‚Çø`, 'error');
                return;
            }
            
            if (toEmail === currentUser.email) {
                showMessage('bankMessage', '‚ùå –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Å–µ–±–µ', 'error');
                return;
            }
            
            const receiver = users.find(u => u.email === toEmail);
            if (!receiver) {
                showMessage('bankMessage', '–ü–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            // –í–´–ü–û–õ–ù–Ø–ï–ú –ü–ï–†–ï–í–û–î
            currentUser.balance -= amount;
            receiver.balance += amount;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            document.getElementById('balance').textContent = `${currentUser.balance} ‚Çø`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (–±–∞–ª–∞–Ω—Å—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å)
            const select = document.getElementById('toUser');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>';
            users.forEach(u => {
                if (u.email !== currentUser.email) {
                    const option = document.createElement('option');
                    option.value = u.email;
                    option.textContent = `${u.email} (${u.balance} ‚Çø)`;
                    select.appendChild(option);
                }
            });
            
            // –°–û–•–†–ê–ù–Ø–ï–ú –í GOOGLE FORM
            const saved = await saveToGoogleForm(currentUser.email, receiver.email, amount);
            
            if (saved) {
                showMessage('bankMessage', 
                    `‚úÖ –ü–µ—Ä–µ–≤–æ–¥ ${amount} ‚Çø ‚Üí ${toEmail}<br>
                    <small>–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ Google Form</small>`, 
                    'success'
                );
            } else {
                showMessage('bankMessage', 
                    `‚úÖ –ü–µ—Ä–µ–≤–æ–¥ ${amount} ‚Çø ‚Üí ${toEmail}<br>
                    <small>–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ</small>`, 
                    'success'
                );
            }
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('amount').value = '';
            document.getElementById('toUser').selectedIndex = 0;
        }
        
        function logout() {
            currentUser = null;
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('bankScreen').style.display = 'none';
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('loginMessage').textContent = '';
        }
        
        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            console.log('–ë–∞–Ω–∫ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
            console.log('Google Form ID:', GOOGLE_FORM_ID);
        };
    </script>
</body>
</html>
