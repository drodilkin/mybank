<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>PayBank</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0b0b0f;
  --card:#15161c;
  --panel:#1f2028;
  --yellow:#ffdd2d;
  --text:#fff;
  --muted:#8b8d98;
  --green:#2ecc71;
  --red:#ff5a5a;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:radial-gradient(circle at top,#1a1b22,#0b0b0f 70%);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  color:var(--text);
}

/* ===== SCREENS ===== */
.screen{
  min-height:100vh;
  padding-bottom:90px;
  animation:fade .35s ease;
}
.hidden{display:none}

@keyframes fade{
  from{opacity:0;transform:translateY(8px)}
  to{opacity:1;transform:none}
}

/* ===== CARDS ===== */
.card{
  background:linear-gradient(180deg,#1a1b22,#14151b);
  border-radius:26px;
  padding:22px;
  margin:16px;
  box-shadow:0 20px 50px rgba(0,0,0,.6);
}

.balance-card{
  background:var(--yellow);
  color:#000;
}

.balance{
  font-size:36px;
  font-weight:700;
}

/* ===== BUTTONS ===== */
.btn{
  width:100%;
  padding:15px;
  border:none;
  border-radius:18px;
  background:var(--yellow);
  color:#000;
  font-size:16px;
  font-weight:600;
  margin-top:14px;
}

.btn.dark{
  background:#2a2b33;
  color:#fff;
}

/* ===== INPUT ===== */
.input{
  width:100%;
  padding:15px;
  background:var(--panel);
  border:none;
  border-radius:16px;
  color:#fff;
  margin-top:12px;
}

/* ===== ACTIONS ===== */
.actions{
  display:flex;
  gap:12px;
  margin:16px;
}

.action{
  flex:1;
  background:var(--panel);
  padding:14px;
  border-radius:18px;
  text-align:center;
}

/* ===== HISTORY ===== */
.tx{
  display:flex;
  justify-content:space-between;
  padding:12px 0;
  border-bottom:1px solid #222;
}
.tx.plus{color:var(--green)}
.tx.minus{color:var(--red)}

/* ===== NAV ===== */
.nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:80px;
  background:#121319;
  display:flex;
  justify-content:space-around;
  align-items:center;
  border-top:1px solid #222;
}

.nav div{
  text-align:center;
  font-size:12px;
  color:var(--muted);
}

.nav .active{
  color:var(--yellow);
}
</style>
</head>

<body>

<!-- ===== HOME ===== -->
<div class="screen" id="home">
  <div class="card balance-card">
    <div>–ë–∞–ª–∞–Ω—Å</div>
    <div class="balance" id="balance">0 ‚ÇΩ</div>
  </div>

  <div class="actions">
    <div class="action" onclick="showTransfer()">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏</div>
    <div class="action" onclick="openScreen('history')">–ò—Å—Ç–æ—Ä–∏—è</div>
  </div>

  <div class="card hidden" id="transfer">
    <input id="to" class="input" placeholder="Email">
    <input id="amount" class="input" placeholder="–°—É–º–º–∞">
    <button class="btn" onclick="transferMoney()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<!-- ===== HISTORY ===== -->
<div class="screen hidden" id="history">
  <div class="card">
    <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
    <div id="historyList"></div>
  </div>
</div>

<!-- ===== PROFILE ===== -->
<div class="screen hidden" id="profile">
  <div class="card">
    <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
    <p id="profileEmail"></p>
    <button class="btn dark" onclick="logout()">–í—ã–π—Ç–∏</button>
  </div>
</div>

<!-- ===== NAV ===== -->
<div class="nav">
  <div class="active" onclick="openScreen('home')">üè†<br>–ì–ª–∞–≤–Ω–∞—è</div>
  <div onclick="openScreen('history')">üìú<br>–ò—Å—Ç–æ—Ä–∏—è</div>
  <div onclick="openScreen('profile')">üë§<br>–ü—Ä–æ—Ñ–∏–ª—å</div>
</div>

<script>
const API_URL='https://script.google.com/macros/s/AKfycbzw2nwKnvc-1zlGcl7p1OYvEk4NdqVIGS6gKrhpJ3XFglkmh7rhbDMARlvNQKclqh31/exec';
let email=localStorage.getItem('email');

/* ===== NAV ===== */
function openScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  document.querySelectorAll('.nav div').forEach(n=>n.classList.remove('active'));
  event.target.closest('div').classList.add('active');
}

/* ===== DATA ===== */
async function loadBalance(){
  const r=await fetch(API_URL,{method:'POST',body:JSON.stringify({action:'balance',email})});
  const d=await r.json();
  balance.textContent=d.balance+' ‚ÇΩ';
}

async function loadHistory(){
  const r=await fetch(API_URL,{method:'POST',body:JSON.stringify({action:'history',email})});
  const data=await r.json();
  historyList.innerHTML='';
  data.forEach(t=>{
    const div=document.createElement('div');
    div.className='tx '+(t.amount>0?'plus':'minus');
    div.innerHTML=`<div>${t.from}</div><div>${t.amount}</div>`;
    historyList.appendChild(div);
  });
}

async function transferMoney(){
  await fetch(API_URL,{
    method:'POST',
    body:JSON.stringify({action:'transfer',from:email,to:to.value,amount:+amount.value})
  });
  loadBalance();
  loadHistory();
  transfer.classList.add('hidden');
}

function showTransfer(){
  transfer.classList.toggle('hidden');
}

function logout(){
  localStorage.clear();
  location.reload();
}

profileEmail.textContent=email;
loadBalance();
loadHistory();
</script>

</body>
</html>
